{% extends "muscu_site/base.html" %}

{% load static %}

{% block title %}Création d'une séance{% endblock %}

{% block content %}
<form method="post">
  {% csrf_token %}

  <div class="block-title text-align-center">

    <div class="title block-adapted-width">
      <label for="{{session_form.session_title.id_for_label}}" class="title-label">
        {{ session_form.session_title.label }}<br>
      </label>
        {{ session_form.session_title }}
    </div>

  </div>

  {{ exercise_formset.management_form }}

  <div class="block-exercises">
    {% for form in exercise_formset %}
    <div class="block-exercise">

      <div class="title-exercise">
        Nom de l'exercice: {{ form.exercise }}
        {% include "muscu_site/_field_errors.html" with field=form.exercice extra_classes="error-validation-list--red" %}
      </div>
      <div class="exercise-creation-block block-adapted-width">
        <div class="exercise-creation-item">
          {{ form.sets.label }}{{ form.sets }}
          {% include "muscu_site/_field_errors.html" with field=form.sets extra_classes="error-validation-list--red" %}
        </div>
        <div class="exercise-creation-item">
          {{ form.reps.label }}{{ form.reps }}
          {% include "muscu_site/_field_errors.html" with field=form.reps extra_classes="error-validation-list--red" %}
        </div>
        <div class="exercise-creation-item">
          {{form.break_time.label }}{{ form.break_time }} sec.
          {% include "muscu_site/_field_errors.html" with field=form.break_time extra_classes="error-validation-list--red" %}
        </div>
      </div>

    </div>
    {% endfor %}
  </div>

  <div>
    <a class= "button-add" href="#">Ajouter un exercice</a>
  </div>

  <div class="on-right">
    <button type="submit" name="button" class="button main-button--white">Enregistrer</button>
  </div>

  <div class="hidden extra-row">
    <div class="block-exercise">

      <div class="title-exercise">
        Nom de l'exercice: {{ exercise_formset.empty_form.exercise }}
      </div>
      <div class="exercise-creation-block block-adapted-width">
        <div class="exercise-creation-item">
          {{ exercise_formset.empty_form.sets.label }}{{ exercise_formset.empty_form.sets }}
        </div>
        <div class="exercise-creation-item">
          {{ exercise_formset.empty_form.reps.label }}{{ exercise_formset.empty_form.reps }}
        </div>
        <div class="exercise-creation-item">
          {{exercise_formset.empty_form.break_time.label }}{{ exercise_formset.empty_form.break_time }} sec.
        </div>
      </div>

    </div>
  </div>

</form>


<script type="text/javascript">
  var buttonAdd = document.querySelector('.button-add');

  function addRow(){
    const extraRow = document.querySelector('.extra-row .block-exercise');
    const blockExercises = document.querySelector('.block-exercises');


    newNbRow = document.querySelector('#id_form-TOTAL_FORMS').value++;
    let clonedRow = extraRow.cloneNode(true);
    clonedRow.innerHTML = clonedRow.innerHTML.replace(/__prefix__/g, newNbRow);
    blockExercises.appendChild(clonedRow);

  }

  buttonAdd.addEventListener('click', addRow);

</script>

{% endblock %}
