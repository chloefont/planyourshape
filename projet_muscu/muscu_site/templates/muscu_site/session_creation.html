{% extends "muscu_site/base.html" %}

{% load static %}

{% block title %}Création d'une séance{% endblock %}

{% block content %}
<form class="" action="" method="post">
  {% csrf_token %}

  <div class="block1 text-align">

    <div class="title">
      <label class="title-label">
        Titre de la séance:<br>
      </label>
        {{ session_form.session_title }}

    </div><br>
    <div class="date">
      <label >
        Date de création:<br>
      </label>
      <input type="date" name="date" value="">
      {{ session_form.date.errors }}

    </div>

  </div>


  <div class="block2">
    {{ exercice_formset.management_form }}

    <div class="second-title">
      <h2><label class="exercice">Exercice</label></h2>
      <h2><label class="sets">Séries</label></h2>
      <h2><label class="reps">Répétitions</label></h2>
      <h2><label class="break_time">Temps de pause</label></h2>
    </div>

    <div class="fields-container">
      {% for form in exercice_formset %}
      <div class="fields-row">
        <div class="fields-col exercice">
          {{form.exercice}}
        </div>
        <div class="fields-col">
          {{form.sets}}
        </div>
        <div class="fields-col">
          {{form.reps}}
        </div>
        <div class="fields-col">
          {{form.break_time}}
        </div><br>
      </div>
      {% endfor %}
    </div>

    <div>
      <a class= "button-add" href="#">Ajouter un exercice</a>
    </div>

    <div class="on-right">
      <button type="submit" name="button" class="button-submit">Enregistrer</button>
    </div>

    <div class="hidden extra-row">
      <div class="fields-row">
        <div class="fields-col exercice">
          {{exercice_formset.empty_form.exercice}}
        </div>
        <div class="fields-col">
          {{exercice_formset.empty_form.sets}}
        </div>
        <div class="fields-col">
          {{exercice_formset.empty_form.reps}}
        </div>
        <div class="fields-col">
          {{exercice_formset.empty_form.break_time}}
        </div><br>
      </div>
    </div>

  </div>

</form>

<script type="text/javascript">
  var buttonAdd = document.querySelector('.button-add');

  function addRow(){
    const extraRow = document.querySelector('.extra-row .fields-row');
    const fieldContainer = document.querySelector('.fields-container');


    newnbRow = document.querySelector('#id_form-TOTAL_FORMS').value++;
    let clonedRow = extraRow.cloneNode(true);
    clonedRow.innerHTML = clonedRow.innerHTML.replace(/__prefix__/g, newnbRow);
    fieldContainer.appendChild(clonedRow);

    //finalExtraRow = extraRow.innerHTML.replace(/__prefix__/g, newnbRow);
    //fieldContainer.innerHTML += finalExtraRow;
  }

  buttonAdd.addEventListener('click', addRow);

</script>

{% endblock %}
